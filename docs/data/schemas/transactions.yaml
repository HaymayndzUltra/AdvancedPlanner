version: 1
entity: transactions
description: Canonical financial transactions for orders and payments
owner: finance-data-platform
pii_classification: contains_pii
fields:
  - name: transaction_id
    type: string
    nullable: false
    constraints:
      - unique
  - name: user_id
    type: string
    nullable: false
  - name: order_id
    type: string
    nullable: false
  - name: amount
    type: number
    nullable: false
    constraints:
      - { min: 0 }
  - name: currency
    type: string
    nullable: false
    constraints:
      - { enum: [USD, EUR, GBP, CAD, AUD, INR, JPY, BRL, MXN] }
  - name: status
    type: string
    nullable: false
    constraints:
      - { enum: [authorized, captured, settled, refunded, voided, chargeback, failed] }
  - name: payment_method
    type: string
    nullable: true
  - name: card_last4
    type: string
    nullable: true
  - name: country_code
    type: string
    nullable: true
    constraints:
      - { regex: '^[A-Z]{2}$' }
  - name: created_at
    type: string
    nullable: false
  - name: updated_at
    type: string
    nullable: false
  - name: settled_at
    type: string
    nullable: true

