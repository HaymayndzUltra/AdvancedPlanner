## Planning Framework (Frontend) — Design Proposal

### 1) Executive Summary
This document proposes a complete, artifact-first planning framework for the frontend (FE) organization. It provides a lifecycle of events from PLANNED to IMPROVE, governed by explicit quality gates and sealed via an immutable handoff manifest. The framework uses interoperable artifacts (YAML/MD/JSON), overlays governance through tags with a Critical=0 rule, and anchors a metrics spine that emits a per-cycle digest for visibility and continuous improvement.

### 2) Deliverables
Per cycle, the framework produces the following artifacts, optimized for artifact-first interop and automation:
- fe_task_breakdown.yaml: Work items (epics/stories/tasks), owners, estimates, dependencies, tags.
- story_map.md: User journey, capabilities, slices, and phased delivery alignment.
- handoff_manifest.yaml: Immutable, sealed manifest with checksums, snapshot_rev, rulebook_hash.
- digest.md: Metrics spine digest summarizing KPIs, gates, and improvement actions.

Suggested locations and naming (cycle_id = YYYY-MM-DD or sprint tag):
- `frameworks/planning-fe/tasks/{cycle_id}-fe_task_breakdown.yaml`
- `frameworks/planning-fe/storymaps/{cycle_id}-story_map.md`
- `frameworks/planning-fe/manifests/{cycle_id}-handoff_manifest.yaml`
- `frameworks/planning-fe/digests/{cycle_id}-digest.md`

Artifact-first interop:
- YAML/JSON: machine-readable, schema-linted; MD: human-first summaries with structured front matter.
- All artifacts reference each other by stable identifiers and are sealed by the handoff manifest.

### 3) Events & Gates
Lifecycle events:
1. PLANNED
2. READY_FOR_HANDOFF
3. PACKAGED
4. EXECUTED
5. VALIDATED
6. IMPROVE

Quality gates applied (minimum) at transitions:
- schema_lint: All YAML/JSON/MD front matter validate against versioned schemas.
- cross_stream_consistency: Dependencies across FE/BE/Design match and are satisfied or stubbed.
- parity/coverage: Story-map parity with backlog and minimum test coverage delta thresholds are met.

Event → Gate mapping (summary):
- PLANNED → READY_FOR_HANDOFF: schema_lint, cross_stream_consistency, parity/coverage (planning level checks).
- READY_FOR_HANDOFF → PACKAGED: schema_lint re-run, manifest pre-check, Critical=0 governance.
- PACKAGED → EXECUTED: release-readiness checks; unchanged manifest checksum confirmation.
- EXECUTED → VALIDATED: outcome validation, KPI measurement, parity/coverage post-exec.
- VALIDATED → IMPROVE: retrospective signatures and improvement backlog entries captured.

### 4) Workflow
Step-by-step per cycle:
1. Author fe_task_breakdown.yaml and story_map.md from discovery inputs.
2. Run schema_lint to ensure artifacts comply with schemas; fix issues until clean.
3. Run cross_stream_consistency to verify FE←→BE dependencies and design/assets alignment.
4. Compute parity/coverage: confirm each story in story_map.md has a corresponding backlog item and required test coverage thresholds are planned (and later measured post-exec).
5. Generate handoff_manifest.yaml with checksums of all referenced artifacts, `snapshot_rev` (e.g., git commit SHA), and `rulebook_hash` (hash of governance rulebook).
6. Seal handoff_manifest.yaml (immutable) and move state to READY_FOR_HANDOFF once gates pass and Critical=0 holds.
7. Package for execution (PACKAGED), ensuring no changes to sealed artifacts; if changes are needed, open a new cycle or increment cycle with a new manifest.
8. Execute delivery (EXECUTED) and collect outcomes (test results, coverage, defects, lead time).
9. Validate outcomes (VALIDATED) against acceptance criteria and governance rules.
10. Publish digest.md with KPIs, gate outcomes, and improvement actions; transition to IMPROVE and seed next cycle.

### 5) Handoff & Sealing
Immutable handoff manifest requirements:
- Checksums: SHA-256 for each artifact path, recorded in a map keyed by normalized path.
- snapshot_rev: Exact VCS revision of the repository state when the manifest was created.
- rulebook_hash: SHA-256 of the governance rulebook (e.g., YAML configuration of policies).
- Signatures: Optional cryptographic signature(s) from accountable roles; required for regulated streams.
- Immutability: Once sealed, the manifest and referenced artifact files cannot be modified. Any change requires a new cycle_id and new manifest.

Manifest schema (illustrative):
```yaml
version: 1
cycle_id: YYYY-MM-DD
snapshot_rev: "<git_sha>"
rulebook_hash: "<sha256>"
artifacts:
  - path: frameworks/planning-fe/tasks/{cycle_id}-fe_task_breakdown.yaml
    sha256: "<sha256>"
  - path: frameworks/planning-fe/storymaps/{cycle_id}-story_map.md
    sha256: "<sha256>"
  - path: frameworks/planning-fe/digests/{cycle_id}-digest.md
    sha256: "<sha256>"
governance:
  tags: ["Release", "Scope:Core", "Risk:Low"]
  critical_issues: 0
sealed_at: "<iso8601>"
sealed_by: ["PM", "TechLead", "QA"]
signature: "<optional-detached-signature>"
```

### 6) Governance Integration
Governance overlay:
- tags[]: Applied at epic/story/task level (e.g., Scope, Risk, Component, Priority, Compliance).
- Critical=0 rule: At handoff and packaging, there must be zero open Critical severity issues (planning defects, security blockers, governance violations). Gate must hard-fail if `critical_issues > 0`.
- Rulebook: Versioned YAML defining rules (thresholds, required tags, approvers). The `rulebook_hash` is included in the manifest to ensure deterministic governance context.
- Enforcement: CI jobs evaluate rules; failures block state transitions. Overrides require a new cycle with documented rationale.

### 7) Metrics & Digest
Metrics spine (KPIs captured per cycle):
- Plan accuracy (% scope completed vs committed)
- Lead time (story start→prod), Cycle time (dev start→merge)
- Test coverage delta (unit/e2e), Accessibility checks pass rate
- Defect counts (by severity), Defect escape rate
- Cross-stream dependency fulfillment rate
- DORA metrics (deployment frequency, change failure rate, MTTR)

Digest file (digest.md) content (summary of the cycle):
- Cycle metadata (cycle_id, dates, snapshot_rev, rulebook_hash)
- KPI table with deltas vs previous cycle
- Gate outcomes (pass/fail) with evidence links
- Manifest excerpt and verification checksum
- Improvement actions (owners, due dates), carried to next fe_task_breakdown.yaml

### 8) Acceptance Criteria
- All four deliverables exist, validate against schemas, and interlink correctly.
- All quality gates pass for each lifecycle transition; evidence is stored.
- Handoff manifest is sealed, immutable, and includes valid checksums, snapshot_rev, and rulebook_hash.
- Governance overlay present with tags[] and Critical=0 satisfied at sealing.
- Digest published with KPIs and improvement actions; metrics are reproducible.

### 9) Risks & Mitigations
- Drift between story_map.md and fe_task_breakdown.yaml → Mitigation: automated parity check, pre-merge hook.
- Governance friction (false positives) → Mitigation: rulebook versioning, fast-feedback linting locally.
- Immutable sealing too early → Mitigation: require READY_FOR_HANDOFF dry run before sealing.
- Cross-stream dependency slippage → Mitigation: explicit dependency contracts and escalation policy.
- Metrics integrity issues → Mitigation: data provenance, snapshot_rev pinning, and checksum verification in CI.

### 10) Timeline & Next Steps
Week 1: Define schemas, wire up schema_lint and basic governance rulebook.
Week 2: Implement cross_stream_consistency checks and parity/coverage calculators.
Week 3: Produce first full cycle artifacts and seal manifest; pilot in one squad.
Week 4: Roll out metrics spine and digest automation; review and refine rulebook.
Next: Expand to multi-stream coordination (FE/BE/Design), integrate with release trains, and automate Critical=0 dashboards.

